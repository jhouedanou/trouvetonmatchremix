{"file":"match-D6nchs6G.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AA6Ec,aAAQ;AACP,cAAS;AAExB,UAAM,UAAU,IAAI,IAAI;AACxB,UAAM,aAAa,IAAI,KAAK;AAC5B,UAAM,cAAc,IAAI,IAAI;AAC5B,UAAM,cAAc,IAAI,IAAI;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["../../../../pages/match.vue"],"sourcesContent":["<template>\n  <section class=\"section\">\n    <div class=\"container\">\n      <div class=\"box\">\n        <div v-if=\"loading\" class=\"has-text-centered\">\n          <h2 class=\"title\">Recherche de votre match...</h2>\n          <div class=\"loader-container\">\n            <div class=\"heart-loader\"></div>\n          </div>\n        </div>\n\n        <div v-else-if=\"matchFound\" class=\"match-result\">\n          <h2 class=\"title\">Félicitations ! Vous avez un match !</h2>\n          <div class=\"columns\">\n            <div class=\"column is-6\">\n              <div class=\"card\">\n                <div class=\"card-image\">\n                  <figure class=\"image\">\n                    <img :src=\"currentUser.photo\" alt=\"Votre photo\" />\n                  </figure>\n                </div>\n                <div class=\"card-content\">\n                  <p class=\"title is-4\">\n                    {{ currentUser.first_name }} {{ currentUser.last_name }}\n                  </p>\n                  <p class=\"subtitle is-6\">{{ currentUser.quartier }}</p>\n                  <p>\n                    Votre choix : {{ currentUser.user_drinks[0].drink_choice }}\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"column is-6\">\n              <div class=\"card\">\n                <div class=\"card-image\">\n                  <figure class=\"image\">\n                    <img :src=\"matchedUser.photo\" alt=\"Photo de votre match\" />\n                  </figure>\n                </div>\n                <div class=\"card-content\">\n                  <p class=\"title is-4\">\n                    {{ matchedUser.first_name }} {{ matchedUser.last_name }}\n                  </p>\n                  <p class=\"subtitle is-6\">{{ matchedUser.quartier }}</p>\n                  <p>Email: {{ matchedUser.email }}</p>\n                  <p>Téléphone: {{ matchedUser.phone }}</p>\n                  <p>\n                    Son choix : {{ matchedUser.user_drinks[0].drink_choice }}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"notification is-success mt-4\">\n            <p>Contactez votre match et organisez votre rencontre !</p>\n          </div>\n        </div>\n\n        <div v-else class=\"no-match-container\">\n          <h2 class=\"title\">Pas de match pour le moment</h2>\n          <p class=\"subtitle\">Nous continuons à chercher votre âme sœur...</p>\n          <div class=\"actions mt-4\">\n            <button class=\"button\" @click=\"findMatch\">Réessayer</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport { supabase } from \"~/utils/supabase\";\n\nconst route = useRoute();\nconst router = useRouter();\n\nconst loading = ref(true);\nconst matchFound = ref(false);\nconst currentUser = ref(null);\nconst matchedUser = ref(null);\n\nconst findMatch = async () => {\n  loading.value = true;\n  matchFound.value = false;\n\n  const { data: userData } = await supabase\n    .from(\"users\")\n    .select(\"*, user_drinks!inner(*)\")\n    .eq(\"id\", route.params.id)\n    .single();\n\n  if (userData) {\n    currentUser.value = userData;\n    const drinkChoice = userData.user_drinks[0].drink_choice;\n\n    const { data: matchData } = await supabase\n      .from(\"users\")\n      .select(\"*, user_drinks!inner(*)\")\n      .eq(\"user_drinks.drink_choice\", drinkChoice)\n      .neq(\"id\", userData.id)\n      .neq(\"gender\", userData.gender)\n      .is(\"matched_email\", null)\n      .single();\n\n    if (matchData) {\n      matchedUser.value = matchData;\n      matchFound.value = true;\n\n      await Promise.all([\n        supabase\n          .from(\"users\")\n          .update({ matched_email: matchData.email })\n          .eq(\"id\", userData.id),\n        supabase\n          .from(\"users\")\n          .update({ matched_email: userData.email })\n          .eq(\"id\", matchData.id),\n      ]);\n    }\n  }\n\n  loading.value = false;\n};\n\nonMounted(() => {\n  findMatch();\n});\n</script>\n\n<style scoped>\n.match-result {\n  text-align: center;\n}\n\n.card {\n  margin-bottom: 2rem;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.image {\n  max-width: 300px;\n  margin: 0 auto;\n}\n\n.image img {\n  border-radius: 8px;\n  object-fit: cover;\n  height: 300px;\n  width: 100%;\n}\n\n.title {\n  color: #c40e0e;\n  margin-bottom: 2rem;\n}\n\n.card-content {\n  padding: 1.5rem;\n}\n\n.loader-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 2rem;\n}\n\n.heart-loader {\n  width: 50px;\n  height: 50px;\n  background-color: #c40e0e;\n  position: relative;\n  transform: rotate(45deg);\n  animation: heartbeat 1.2s infinite;\n}\n\n.heart-loader:before,\n.heart-loader:after {\n  content: \"\";\n  width: 50px;\n  height: 50px;\n  background-color: #c40e0e;\n  border-radius: 50%;\n  position: absolute;\n}\n\n.heart-loader:before {\n  left: -25px;\n}\n\n.heart-loader:after {\n  top: -25px;\n}\n\n@keyframes heartbeat {\n  0% {\n    transform: rotate(45deg) scale(1);\n  }\n  25% {\n    transform: rotate(45deg) scale(1.1);\n  }\n  50% {\n    transform: rotate(45deg) scale(1);\n  }\n  75% {\n    transform: rotate(45deg) scale(1.1);\n  }\n  100% {\n    transform: rotate(45deg) scale(1);\n  }\n}\n\n.no-match-container {\n  text-align: center;\n  padding: 3rem;\n}\n\n.button.is-primary {\n  background-color: #c40e0e;\n  color: white;\n  border: none;\n  padding: 1rem 2rem;\n  font-weight: bold;\n  transition: all 0.3s ease;\n}\n\n.button.is-primary:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 8px rgba(196, 14, 14, 0.2);\n}\n</style>\n"],"version":3}