import{_ as v,u as p,m as f,r as n,p as k,c as l,a as s,t,o as r}from"./B4E3WV-G.js";import{s as d}from"./8foywVBM.js";const g={class:"section"},b={class:"container"},q={class:"box"},x={key:0,class:"has-text-centered"},y={key:1,class:"match-result"},R={class:"columns"},V={class:"column is-6"},w={class:"card"},z={class:"card-image"},B={class:"image"},C=["src"],D={class:"card-content"},P={class:"title is-4"},E={class:"subtitle is-6"},F={class:"column is-6"},M={class:"card"},N={class:"card-image"},S={class:"image"},U=["src"],I={class:"card-content"},T={class:"title is-4"},j={class:"subtitle is-6"},A={key:2,class:"no-match-container"},G={__name:"match",setup(H){const h=p();f();const u=n(!0),_=n(!1),i=n(null),a=n(null),m=async()=>{u.value=!0,_.value=!1;const{data:o}=await d.from("users").select("*, user_drinks!inner(*)").eq("id",h.params.id).single();if(o){i.value=o;const e=o.user_drinks[0].drink_choice,{data:c}=await d.from("users").select("*, user_drinks!inner(*)").eq("user_drinks.drink_choice",e).neq("id",o.id).neq("gender",o.gender).is("matched_email",null).single();c&&(a.value=c,_.value=!0,await Promise.all([d.from("users").update({matched_email:c.email}).eq("id",o.id),d.from("users").update({matched_email:o.email}).eq("id",c.id)]))}u.value=!1};return k(()=>{m()}),(o,e)=>(r(),l("section",g,[s("div",b,[s("div",q,[u.value?(r(),l("div",x,e[0]||(e[0]=[s("h2",{class:"title"},"Recherche de votre match...",-1),s("div",{class:"loader-container"},[s("div",{class:"heart-loader"})],-1)]))):_.value?(r(),l("div",y,[e[1]||(e[1]=s("h2",{class:"title"},"Félicitations ! Vous avez un match !",-1)),s("div",R,[s("div",V,[s("div",w,[s("div",z,[s("figure",B,[s("img",{src:i.value.photo,alt:"Votre photo"},null,8,C)])]),s("div",D,[s("p",P,t(i.value.first_name)+" "+t(i.value.last_name),1),s("p",E,t(i.value.quartier),1),s("p",null," Votre choix : "+t(i.value.user_drinks[0].drink_choice),1)])])]),s("div",F,[s("div",M,[s("div",N,[s("figure",S,[s("img",{src:a.value.photo,alt:"Photo de votre match"},null,8,U)])]),s("div",I,[s("p",T,t(a.value.first_name)+" "+t(a.value.last_name),1),s("p",j,t(a.value.quartier),1),s("p",null,"Email: "+t(a.value.email),1),s("p",null,"Téléphone: "+t(a.value.phone),1),s("p",null," Son choix : "+t(a.value.user_drinks[0].drink_choice),1)])])])]),e[2]||(e[2]=s("div",{class:"notification is-success mt-4"},[s("p",null,"Contactez votre match et organisez votre rencontre !")],-1))])):(r(),l("div",A,[e[3]||(e[3]=s("h2",{class:"title"},"Pas de match pour le moment",-1)),e[4]||(e[4]=s("p",{class:"subtitle"},"Nous continuons à chercher votre âme sœur...",-1)),s("div",{class:"actions mt-4"},[s("button",{class:"button",onClick:m},"Réessayer")])]))])])]))}},L=v(G,[["__scopeId","data-v-b0288b72"]]);export{L as default};
